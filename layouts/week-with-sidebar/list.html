{{ define "main" }}
<div class="course-page-layout">
  <div class="course-container">
    {{ partial "course-sidebar.html" . }}

    <!-- Main Content -->
  <main class="course-content px-6 py-6">
      <div class="px-6 py-6">
        {{ $course := .Params.course }}
        {{ $week := .Params.week }}
        
        <!-- Week Title -->
        <h1 class="text-3xl sm:text-4xl font-bold text-slate-900 mb-2">{{ .Title }}</h1>
      
      <!-- Week Description/Topics -->
      {{ with .Params.description }}
        <p class="text-slate-600 text-sm sm:text-base mb-6 leading-relaxed">{{ . }}</p>
      {{ end }}

      <!-- Lecture Video Section -->
      <div class="mb-10">
        {{ if .Params.youtube }}
          {{ partial "youtube-embed.html" (dict "url" .Params.youtube) }}
        {{ else }}
          <div class="aspect-video bg-slate-100 rounded-lg flex items-center justify-center">
            <p class="text-slate-500">Video sẽ sớm được cập nhật</p>
          </div>
        {{ end }}
      </div>

      <!-- Collapsible Sections -->
      <div class="space-y-3 mb-10">
        <!-- How to download source code -->
        <details class="group border border-slate-200 rounded-lg">
          <summary class="flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-slate-50 transition-colors">
            <span class="text-slate-700 font-medium flex items-center gap-2">
              <svg class="w-4 h-4 text-slate-400 group-open:rotate-90 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
              How to download source code into VS Code
            </span>
          </summary>
          <div class="px-4 py-3 border-t border-slate-200 bg-slate-50 text-sm text-slate-600">
            <p>Instructions for downloading source code will be provided here.</p>
          </div>
        </details>

        <!-- Lecture Section -->
        <details class="group border border-slate-200 rounded-lg" open>
          <summary class="flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-slate-50 transition-colors">
            <span class="text-slate-700 font-medium flex items-center gap-2">
              <svg class="w-4 h-4 text-slate-400 group-open:rotate-90 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
              Lecture
            </span>
          </summary>
          <div class="px-4 py-3 border-t border-slate-200 bg-white">
            <ul class="space-y-2">
              <!-- Notes -->
              {{ $notes := first 1 (where .Pages "Type" "notes") }}
              {{ with $notes }}
                {{ $n := index . 0 }}
                <li class="ml-4">
                  <div class="flex items-start gap-2">
                    <span class="text-slate-400 mt-1">•</span>
                    <div>
                      <a href="{{ $n.RelPermalink }}" class="text-blue-600 hover:underline font-medium">Notes</a>
                      {{ with $n.Params.description }}
                        <p class="text-slate-600 text-sm mt-0.5">{{ . }}</p>
                      {{ end }}
                    </div>
                  </div>
                </li>
              {{ end }}
              
              <!-- Slides -->
              <li class="ml-4">
                <details class="group/slides">
                  <summary class="cursor-pointer">
                    <span class="text-slate-400">▸</span>
                    <span class="text-slate-700 font-medium ml-2 group-open/slides:text-slate-900">Slides</span>
                  </summary>
                  <ul class="ml-6 mt-2 space-y-1 text-sm">
                    <li><a href="#" class="text-blue-600 hover:underline">Google Slides</a></li>
                    <li><a href="#" class="text-blue-600 hover:underline">PDF</a></li>
                  </ul>
                </details>
              </li>

              <!-- Source Code -->
              <li class="ml-4">
                <details class="group/source">
                  <summary class="cursor-pointer">
                    <span class="text-slate-400">▸</span>
                    <span class="text-slate-700 font-medium ml-2 group-open/source:text-slate-900">Source Code</span>
                  </summary>
                  <ul class="ml-6 mt-2 space-y-1 text-sm">
                    <li><a href="#" class="text-blue-600 hover:underline">Index</a></li>
                  </ul>
                </details>
              </li>
            </ul>
          </div>
        </details>

        <!-- Problem Sets Section -->
        {{ $psets := where .Pages "Type" "psets-list" }}
        {{ with first 1 $psets }}
          {{ $psSec := index . 0 }}
          <details class="group border border-slate-200 rounded-lg">
            <summary class="flex items-center justify-between px-4 py-3 cursor-pointer hover:bg-slate-50 transition-colors">
              <span class="text-slate-700 font-medium flex items-center gap-2">
                <svg class="w-4 h-4 text-slate-400 group-open:rotate-90 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
                Problem Set {{ $week }}
              </span>
            </summary>
            <div class="px-4 py-3 border-t border-slate-200 bg-white">
              <ul class="space-y-2">
                {{ range $psSec.Pages }}
                <li class="ml-4">
                  <div class="flex items-start gap-2">
                    <span class="text-slate-400 mt-1">•</span>
                    <div>
                      <a href="{{ .RelPermalink }}" class="text-blue-600 hover:underline font-medium">{{ .Title }}</a>
                      {{ with .Params.description }}
                        <p class="text-slate-600 text-sm mt-0.5">{{ . }}</p>
                      {{ end }}
                    </div>
                  </div>
                </li>
                {{ end }}
              </ul>
            </div>
            </details>
          {{ end }}
        </div>
      </div>
    </main>
  </div>
</div>
{{ end }}