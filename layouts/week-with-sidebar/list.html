{{ define "main" }}
{{ partial "mobile-navbar.html" . }}
<div class="flex">
  {{ if not (or .IsHome (eq .Type "courses-root")) }}
    {{ partial "course-sidebar.html" . }}
  {{ end }}
  
  <!-- Main Content -->
  <main class="flex-1 ml-0 lg:ml-80 p-6 lg:p-12 max-w-3xl">
    {{ $course := .Params.course }}
    {{ $week := .Params.week }}
    
    <h1 class="text-4xl font-bold text-slate-900 mb-6">{{ .Title }}</h1>
    {{ with .Params.description }}
      <p class="text-slate-700 mb-8 leading-relaxed">{{ . }}</p>
    {{ end }}

    <!-- Lecture Video -->
    <div class="mb-8">
      <h2 class="text-2xl font-bold text-slate-900 mb-4">Lecture Video</h2>
      {{ if .Params.youtube }}
        {{ partial "youtube-embed.html" (dict "url" .Params.youtube) }}
      {{ else }}
        <p class="text-slate-600">Video sẽ sớm được cập nhật. Tạm thời bạn có thể dùng placeholder: <a class="text-blue-600 underline" href="https://youtu.be/example" target="_blank" rel="noopener noreferrer">https://youtu.be/example</a></p>
      {{ end }}
    </div>

    <!-- Notes Section -->
    {{ $notes := first 1 (where .Pages "Type" "notes") }}
    {{ with $notes }}
      {{ $n := index . 0 }}
      <div class="mb-8">
        <h2 class="text-2xl font-bold text-slate-900 mb-4">Notes</h2>
        <p class="text-slate-700 mb-4 leading-relaxed">{{ with $n.Params.description }}{{ . }}{{ else }}Ghi chú bài giảng cho tuần này.{{ end }}</p>
        <a class="text-blue-600 hover:underline" href="{{ $n.RelPermalink }}">View Notes →</a>
      </div>
    {{ end }}

    <!-- Problem Sets Section -->
    {{ $psets := where .Pages "Type" "psets-list" }}
    {{ with first 1 $psets }}
      {{ $psSec := index . 0 }}
      <div class="mb-8">
        <h2 class="text-2xl font-bold text-slate-900 mb-4">Problem Sets</h2>
        <div class="space-y-3">
          {{ range $psSec.Pages }}
          <div>
            <a href="{{ .RelPermalink }}" class="text-blue-600 hover:underline text-lg">
              {{ .Title }}
            </a>
            {{ with .Params.description }}
              <p class="text-slate-600 text-sm mt-1">{{ . }}</p>
            {{ end }}
          </div>
          {{ end }}
        </div>
      </div>
    {{ end }}
  </main>
</div>
{{ end }}
